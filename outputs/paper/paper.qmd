---
title: "Modeling Mortality Trends in Alberta"
subtitle: "A Quantitative Approach to Public Health Dynamics"
author: 
  - Ziheng Zhong
thanks: "Code and data are available at: https://github.com/iJustinn/Alberta_Mortality_Rate.git"
date: today
date-format: long
abstract: "Abstract"
format: pdf
toc: true
toc-depth: 3
number-sections: true
bibliography: references.bib
---

```{r}
#| message: false
#| echo: false

# load packages
packages <- c("tidyverse", "boot", "broom.mixed", "collapse", "dataverse", "gutenbergr", "janitor", "knitr", "marginaleffects", "modelsummary", "rstanarm", "tidybayes")

# Function to check and install missing packages
install_and_load <- function(packages) {
  for (package in packages) {
    if (!require(package, character.only = TRUE)) {
      install.packages(package)
      library(package, character.only = TRUE)
    }
  }
}

# Call the function with the list of packages
install_and_load(packages)
```

```{r}
#| message: false
#| echo: false

# read in data
file_path_0 <- "../../inputs/data/raw_data.csv"
file_path_1 <- "../../outputs/data/cleaned_data.csv"
file_path_2 <- "../../outputs/data/top_5_cause_data.csv"
file_path_3 <- "../../outputs/data/summarized_top_5_cause_data.csv"

raw_data <- read_csv(file_path_0, show_col_types = FALSE)
cleaned_data <- read_csv(file_path_1, show_col_types = FALSE)
top_5_cause_data <- read_csv(file_path_2, show_col_types = FALSE)
summarized_top_5_cause_data <- read_csv(file_path_3, show_col_types = FALSE)
```



# Introduction

Alberta, a province known for its vibrant culture and dynamic economy, faces ongoing challenges in public health, with mortality rates reflecting a complex interplay of socioeconomic, environmental, and healthcare factors. This paper aims to delve into the intricacies of mortality rates in Alberta, exploring the trends, causes, and determinants that shape the province's public health landscape. By leveraging data on causes of death, including chronic diseases, accidents, and emerging health threats, we provide a detailed analysis of mortality patterns and their implications for Alberta's healthcare system and policy-making.

# Data {#sec-data}

Data used in this paper was cleaned and processed with the programming language R [@citeR]. Also with support of additional packages in R: `tidyverse` [@citeTidyverse], `ggplot2` [@citeGgplot], `janitor` [@citeJanitor], `readr` [@citeReadr], `knitr` [@citeKnitr], `rstanarm` [@citeRstanarm], `modelsummary` [@citeModelsummary], `tidybayes` [@citeTidybayes].

## Source

In the pursuit of understanding and modeling mortality trends within Alberta, our study primarily utilizes the "Leading Causes of Death" dataset made available by the Alberta Open Government Portal. This comprehensive data source offers an extensive overview of mortality statistics across the province, categorized by various causes of death. The Alberta Open Government Portal, a key initiative for promoting transparency and public engagement, hosts this dataset at open.alberta.ca [@citeDatasource], providing open access to valuable health-related data.

The "Leading Causes of Death" dataset encompasses a detailed compilation of death counts and mortality rates spanning multiple years. It includes categorizations by age, sex, and specific causes of death, ranging from chronic diseases to accidents and emergent health threats. This granularity allows for a nuanced analysis of mortality trends, facilitating the identification of prevalent health issues and potential public health interventions.

The selection of this data source was driven by its credibility, comprehensiveness, and relevance to our research objectives. Being an official government resource, the dataset ensures reliability and accuracy, crucial for the validity of our analytical models. The dataset's extensive coverage of demographic and cause-specific mortality information enables a thorough exploration of the factors influencing mortality rates in Alberta. Furthermore, the data's organization and accessibility significantly aid in the efficient processing and modeling of mortality trends.

## Method

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: tbl-causes
#| tbl-cap: top 8 major causes in 2019

#### check top 8 major causes in 2019 ####
cleaned_data |>
  filter(
    calendar_year == 2019,
    ranking <= 8
  ) |>
  mutate(total_deaths = format(total_deaths, big.mark = ",")) |>
  kable(
    col.names = c("Year", "Cause", "Ranking", "Deaths", "Years"),
    align = c("l", "r", "r", "r", "r"),
    digits = 0, booktabs = TRUE, linesep = ""
  )

```

Our analysis commenced with the essential task of refining the raw dataset. The initial phase involved cleaning and standardizing the dataset's variable names to enhance readability and analytical efficiency. We also aggregated the data to quantify the prevalence of each cause of death, thereby streamlining the dataset for more focused analysis. A critical aspect of our methodology was the isolation of data from the year 2019. This strategic choice was made to examine mortality trends immediately before the onset of the COVID-19 pandemic. By focusing on this specific year, we aimed to establish a baseline understanding of mortality patterns unaffected by the pandemic's impact. Within this scope, as showing in @tbl-causes, we identified and prioritized the top 8 causes of mortality, based on their significance and prevalence.

Building on the refined dataset, our analysis further narrowed to investigate the top 5 causes of mortality in 2019. This deliberate focus allowed us to concentrate our efforts on the most impactful health challenges faced by Alberta before the pandemic. We applied statistical models to fit these mortality trends, seeking to identify underlying patterns and determinants. This approach was aimed at uncovering insights that could inform public health strategies and interventions, contributing to a more nuanced understanding of mortality dynamics in the province.

# Results

```{r}
#| include: false

#### poisson model ####
cause_of_death_alberta_poisson <-
  stan_glm(
    total_deaths ~ cause,
    data = top_5_cause_data,
    family = poisson(link = "log"),
    seed = 123
  )

#### negative binomial model ####
cause_of_death_alberta_neg_binomial <-
  stan_glm(
    total_deaths ~ cause,
    data = top_5_cause_data,
    family = neg_binomial_2(link = "log"),
    seed = 123
  )

```

## Data Trend

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: fig-trends
#| fig-cap: Trend for Alberta Mortality
#| fig-subcap: ["Top 5 Causes","Sum of Causes"]
#| layout-ncol: 2
#| layout-nrow: 1

top_5_cause_data |>
  ggplot(aes(x = calendar_year, y = total_deaths, color = cause)) +
  geom_line() +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  labs(x = "Year", y = "Annual Number of deaths in Alberta") +
  facet_wrap(vars(cause), dir = "v", ncol = 1) +
  theme(legend.position = "none",
        axis.text.y = element_text(size = rel(0.7)))

summarized_top_5_cause_data |>
  ggplot(aes(x = calendar_year, y = sum_deaths)) +
  geom_line() +
  theme_minimal() +
  scale_x_continuous(breaks = unique(summarized_top_5_cause_data$calendar_year)) +
  labs(x = "Year", y = "Sum of Annual Number of Deaths in Alberta") +
  theme(legend.position = "none",
        axis.text.x = element_text(size = rel(0.7)))

```

Results in the @fig-trends-1 displays the annual number of deaths in Alberta for the top five causes in 2019 unveils distinct trends for each cause over approximately two decades. The data suggest a relatively stable trend in deaths from acute myocardial infarction, with a small rise that may indicate a steady prevalence of risk factors or an equilibrium between advancing medical interventions and demographic shifts. Conversely, the increasing trajectory seen in deaths due to chronic diseases points to a potential escalation in lifestyle-related health issues or could reflect the demographic realities of an aging population.

Particularly notable is the sharp increase in deaths attributed to organic dementia, surging upwards more markedly in the latter half of the time span. This trend could signify heightened awareness and improved diagnostic capabilities, alongside the impact of an aging society. Meanwhile, deaths from malignant neoplasms related to the respiratory system display minor fluctuations, hinting at persistent challenges in cancer prevention, detection, and treatment. The upward trend in chronic obstructive pulmonary disease-related mortality could be linked to environmental factors or historic smoking patterns, underscoring the pressing need for robust public health policies and effective healthcare strategies.

The graph presented in @fig-trends-2 illustrates a clear upward trajectory in the total number of deaths from 2001 to 2022. This trend, while indicative of a rising mortality rate, necessitates a nuanced interpretation. The increasing death toll may not necessarily be attributed to the lethality or prevalence of specific causes alone. Instead, it potentially reflects broader demographic changes, such as the growth of the overall population, particularly within older age groups who are statistically more vulnerable to various health-related fatalities.

## Modeling

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: tbl-summary
#| tbl-cap: summary of modeling

name_mapping <- 
  c("causeAll other forms of chronic ..."
    = "other chronic",
    "causeMalignant neoplasms of trac..."
    = "neoplasms",
    "causeOrganic dementia"
    = "dementia",
    "causeOther chronic obstructive p..."
    = "obstructive pulmonary"
  )

modelsummary(
  list(
    "Poisson" = cause_of_death_alberta_poisson,
    "Negative binomial" = cause_of_death_alberta_neg_binomial
  ),
  coef_map = name_mapping
)
```

Then the @tbl-summary summarizes the coefficients of both models built to fit the mortality trend in Alberta, offering a comparison of their estimations for the top causes of mortality. In both models, "other chronic" conditions and "neoplasms" exhibit positive coefficients, suggesting these causes of death have an increasing trend over time. Meanwhile, "obstructive pulmonary" diseases show a negative relationship in both models, indicating a decreasing trend in mortality rates. The consistency across both models reinforces the reliability of our findings.

For the Poisson model, the expected log count is defined as:

$$
\log(\mu_i) = \beta_0 + 0.447 \times (\text{other chronic})_i + 0.223 \times (\text{neoplasms})_i + 0.046 \times (\text{dementia})_i -
$$
$$
0.205 \times (\text{obstructive pulmonary})_i
$$

For the Negative Binomial model, the expected log count is defined as:

$$
\log(\mu_i) = \beta_0 + 0.449 \times (\text{other chronic})_i + 0.226 \times (\text{neoplasms})_i + 0.048 \times (\text{dementia})_i -
$$
$$
0.203 \times (\text{obstructive pulmonary})_i
$$

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: fig-models
#| fig-cap: Model Results
#| fig-subcap: ["Poisson Model","Negative Binomial Model"]
#| layout-ncol: 2
#| layout-nrow: 1

pp_check(cause_of_death_alberta_poisson) +
  theme(legend.position = "bottom")

pp_check(cause_of_death_alberta_neg_binomial) +
  theme(legend.position = "bottom")

```

Then to see how good two models fits the original data. We can reffer to the values in the lower half of @tbl-summary, but it's always more clear to see the visual, as depicted by the graphs for the Poisson (@fig-models-1) and negative binomial models (@fig-models-2), the diagnostic plots further elucidate the model fits. The negative binomial model, appears to capture the dispersion in the data more effectively than the Poisson model, which is evident in two plots. The spread of the simulated lines (y_rep) around the observed data (y) suggests that the negative binomial model may accommodate the overdispersion present in the data, which is a common characteristic in count data such as mortality rates.

The presence of multiple peaks in the second plot's simulated data distributions indicates potential subgroups within the data or non-linearity in the mortality trends that the Poisson model may not be accounting for. Such patterns underscore the importance of considering different model structures when dealing with complex datasets. These graphical diagnostics not only affirm the adequacy of the negative binomial model over the Poisson model for this particular dataset but also highlight the necessity of thorough model checking in the process of statistical analysis.

# Discussion

The preceding sections have laid the groundwork for a comprehensive analysis of mortality trends in Alberta, paving the way for this discussion. The application of Poisson and Negative Binomial models to the data has illuminated key trends and has provided quantitative support to the qualitative observations made earlier. The positive coefficients for "other chronic" and "neoplasms" in both models suggest that deaths from these causes have steadily increased, raising questions about the broader factors at play beyond the healthcare system's direct influence. Simultaneously, the negative coefficient for "obstructive pulmonary" diseases suggests a decline in mortality from these conditions, potentially reflecting successful public health initiatives and changing social habits, such as reduced smoking rates.

However, the increasing overall mortality trend signals a need to consider demographic shifts, such as population growth and aging, as significant contributors to the observed patterns. The spike in deaths from 2020 onwards aligns with the onset of the COVID-19 pandemic, underscoring the substantial impact of infectious disease outbreaks on mortality statistics. This outlier emphasizes the importance of having robust health surveillance systems that can adapt to sudden changes in public health landscapes.

Furthermore, the diagnostic plots from both models underscore the necessity for careful selection of appropriate statistical methods when modeling complex health data. The better fit of the Negative Binomial model compared to the Poisson model, as indicated by the diagnostic checks, suggests that overdispersion—a common feature in count data—must be accounted for to avoid underestimating the variability in the data.

The limitations of the current study also warrant discussion. While the models applied provide valuable insights, they do not capture all the nuances of the data. Future research could explore the inclusion of additional variables, such as economic indicators, healthcare access measures, and lifestyle factors, to better understand the determinants of mortality. Moreover, the investigation of interactions between causes of death and demographic variables could yield a more granular understanding of the dynamics at play.

Ultimately, this study serves as a call to action for ongoing surveillance, research, and a proactive approach to public health planning. By continuing to refine our models and expand our datasets, we can better anticipate and mitigate the factors contributing to mortality, striving for a healthier future for all Albertans.

# Conclusion

In conclusion, our exploration of mortality trends in Alberta has provided a statistical narration of the province's public health status over the past two decades. We have identified critical causes of death and trends that warrant attention from both healthcare providers and policymakers. The analysis has also emphasized the significance of employing appropriate statistical models to accurately represent and understand complex health data. As we move forward, it is imperative to integrate these findings into a strategic framework that enhances Alberta's health system responsiveness and effectiveness in the face of demographic and epidemiological shifts. Through vigilance and informed action, we can aim to influence these mortality trends positively, enhancing the health and well-being of the Alberta population.

\newpage




\newpage


# References


