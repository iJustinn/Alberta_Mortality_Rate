---
title: "Title"
subtitle: "Subtitle"
author: 
  - Ziheng Zhong
thanks: "Code and data are available at: https://github.com/iJustinn/Alberta_Mortality_Rate.git"
date: today
date-format: long
abstract: "Abstract"
format: pdf
toc: true
toc-depth: 3
number-sections: true
bibliography: references.bib
---

```{r}
#| message: false
#| echo: false

# load packages
packages <- c("tidyverse", "boot", "broom.mixed", "collapse", "dataverse", "gutenbergr", "janitor", "knitr", "marginaleffects", "modelsummary", "rstanarm")

# Function to check and install missing packages
install_and_load <- function(packages) {
  for (package in packages) {
    if (!require(package, character.only = TRUE)) {
      install.packages(package)
      library(package, character.only = TRUE)
    }
  }
}

# Call the function with the list of packages
install_and_load(packages)
```

```{r}
#| message: false
#| echo: false

# read in data
file_path <- "../../outputs/data/filtered_data.csv"
filtered_data <- read_csv(file_path, show_col_types = FALSE)
```



# Introduction

Alberta, a province known for its vibrant culture and dynamic economy, faces ongoing challenges in public health, with mortality rates reflecting a complex interplay of socioeconomic, environmental, and healthcare factors. This paper aims to delve into the intricacies of mortality rates in Alberta, exploring the trends, causes, and determinants that shape the province's public health landscape. By leveraging data on causes of death, including chronic diseases, accidents, and emerging health threats, we provide a detailed analysis of mortality patterns and their implications for Alberta's healthcare system and policy-making.

This paper utilize data from open.alberta.ca as bases.

# Data {#sec-data}

Data used in this paper was cleaned and processed with the programming language R [@citeR]. Also with support of additional packages in R: `tidyverse` [@citeTidyverse], `ggplot2` [@citeGgplot], `janitor` [@citeJanitor], `dplyr` [@citeDplyr], `readr` [@citeReadr], `knitr` [@citeknitr], 'kableExtra' [@citeKableExtra], 'reshape2' [@citeReshape2].

## Source



## Method



## Attibutes



# Results



```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: fig-poisson_model
#| fig-cap: result for poisson model

#### poisson model ####
cause_of_death_alberta_poisson <-
  stan_glm(
    total_deaths ~ cause,
    data = filtered_data,
    family = poisson(link = "log"),
    seed = 123
  )

#### negative binomial model ####
cause_of_death_alberta_neg_binomial <-
  stan_glm(
    total_deaths ~ cause,
    data = filtered_data,
    family = neg_binomial_2(link = "log"),
    seed = 123
  )

filtered_data |>
  ggplot(aes(x = calendar_year, y = total_deaths, color = cause)) +
  geom_line() +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  labs(x = "Year", y = "Annual number of deaths in Alberta") +
  facet_wrap(vars(cause), dir = "v", ncol = 1) +
  theme(legend.position = "none")

pp_check(cause_of_death_alberta_poisson) +
  theme(legend.position = "bottom")

pp_check(cause_of_death_alberta_neg_binomial) +
  theme(legend.position = "bottom")

```



```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: tbl-summary
#| tbl-cap: summary of modeling

name_mapping <- 
  c("causeAll other forms of chronic ..."
    = "other chronic",
    "causeMalignant neoplasms of trac..."
    = "neoplasms",
    "causeOrganic dementia"
    = "dementia",
    "causeOther chronic obstructive p..."
    = "obstructive pulmonary"
  )

modelsummary(
  list(
    "Poisson" = cause_of_death_alberta_poisson,
    "Negative binomial" = cause_of_death_alberta_neg_binomial
  ),
  coef_map = name_mapping
)
```



# Discussion



# Conclusion






\newpage




\newpage


# References


