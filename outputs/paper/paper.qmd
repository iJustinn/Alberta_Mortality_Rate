---
title: "Modeling Mortality Trends in Alberta"
subtitle: "A Quantitative Approach to Public Health Dynamics"
author: 
  - Ziheng Zhong
thanks: "Code and data are available at: https://github.com/iJustinn/Alberta_Mortality_Rate.git"
date: today
date-format: long
abstract: "Abstract"
format: pdf
toc: true
toc-depth: 3
number-sections: true
bibliography: references.bib
---

```{r}
#| message: false
#| echo: false

# load packages
packages <- c("tidyverse", "boot", "broom.mixed", "collapse", "dataverse", "gutenbergr", "janitor", "knitr", "marginaleffects", "modelsummary", "rstanarm")

# Function to check and install missing packages
install_and_load <- function(packages) {
  for (package in packages) {
    if (!require(package, character.only = TRUE)) {
      install.packages(package)
      library(package, character.only = TRUE)
    }
  }
}

# Call the function with the list of packages
install_and_load(packages)
```

```{r}
#| message: false
#| echo: false

# read in data
file_path_0 <- "../../inputs/data/raw_data.csv"
file_path_1 <- "../../outputs/data/filtered_data.csv"
file_path_2 <- "../../outputs/data/cleaned_data.csv"

raw_data <- read_csv(file_path_0, show_col_types = FALSE)
filtered_data <- read_csv(file_path_1, show_col_types = FALSE)
cleaned_data <- read_csv(file_path_2, show_col_types = FALSE)
```



# Introduction

Alberta, a province known for its vibrant culture and dynamic economy, faces ongoing challenges in public health, with mortality rates reflecting a complex interplay of socioeconomic, environmental, and healthcare factors. This paper aims to delve into the intricacies of mortality rates in Alberta, exploring the trends, causes, and determinants that shape the province's public health landscape. By leveraging data on causes of death, including chronic diseases, accidents, and emerging health threats, we provide a detailed analysis of mortality patterns and their implications for Alberta's healthcare system and policy-making.

# Data {#sec-data}

Data used in this paper was cleaned and processed with the programming language R [@citeR]. Also with support of additional packages in R: `tidyverse` [@citeTidyverse], `ggplot2` [@citeGgplot], `janitor` [@citeJanitor], `readr` [@citeReadr], `knitr` [@citeKnitr], `rstanarm` [@citeRstanarm], `modelsummary` [@citeModelsummary].

## Source

In the pursuit of understanding and modeling mortality trends within Alberta, our study primarily utilizes the "Leading Causes of Death" dataset made available by the Alberta Open Government Portal. This comprehensive data source offers an extensive overview of mortality statistics across the province, categorized by various causes of death. The Alberta Open Government Portal, a key initiative for promoting transparency and public engagement, hosts this dataset at open.alberta.ca [@citeDatasource], providing open access to valuable health-related data.

The "Leading Causes of Death" dataset encompasses a detailed compilation of death counts and mortality rates spanning multiple years. It includes categorizations by age, sex, and specific causes of death, ranging from chronic diseases to accidents and emergent health threats. This granularity allows for a nuanced analysis of mortality trends, facilitating the identification of prevalent health issues and potential public health interventions.

The selection of this data source was driven by its credibility, comprehensiveness, and relevance to our research objectives. Being an official government resource, the dataset ensures reliability and accuracy, crucial for the validity of our analytical models. The dataset's extensive coverage of demographic and cause-specific mortality information enables a thorough exploration of the factors influencing mortality rates in Alberta. Furthermore, the data's organization and accessibility significantly aid in the efficient processing and modeling of mortality trends.

## Method

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: tbl-causes
#| tbl-cap: top 8 major causes in 2019

#### check top 8 major causes in 2019 ####
cleaned_data |>
  filter(
    calendar_year == 2019,
    ranking <= 8
  ) |>
  mutate(total_deaths = format(total_deaths, big.mark = ",")) |>
  kable(
    col.names = c("Year", "Cause", "Ranking", "Deaths", "Years"),
    align = c("l", "r", "r", "r", "r"),
    digits = 0, booktabs = TRUE, linesep = ""
  )

```

Our analysis commenced with the essential task of refining the raw dataset. The initial phase involved cleaning and standardizing the dataset's variable names to enhance readability and analytical efficiency. We also aggregated the data to quantify the prevalence of each cause of death, thereby streamlining the dataset for more focused analysis. A critical aspect of our methodology was the isolation of data from the year 2019. This strategic choice was made to examine mortality trends immediately before the onset of the COVID-19 pandemic. By focusing on this specific year, we aimed to establish a baseline understanding of mortality patterns unaffected by the pandemic's impact. Within this scope, as showing in @tbl-causes, we identified and prioritized the top 8 causes of mortality, based on their significance and prevalence.

Building on the refined dataset, our analysis further narrowed to investigate the top 5 causes of mortality in 2019. This deliberate focus allowed us to concentrate our efforts on the most impactful health challenges faced by Alberta before the pandemic. We applied statistical models to fit these mortality trends, seeking to identify underlying patterns and determinants. This approach was aimed at uncovering insights that could inform public health strategies and interventions, contributing to a more nuanced understanding of mortality dynamics in the province.

# Results

```{r}
#| include: false

#### poisson model ####
cause_of_death_alberta_poisson <-
  stan_glm(
    total_deaths ~ cause,
    data = filtered_data,
    family = poisson(link = "log"),
    seed = 123
  )

#### negative binomial model ####
cause_of_death_alberta_neg_binomial <-
  stan_glm(
    total_deaths ~ cause,
    data = filtered_data,
    family = neg_binomial_2(link = "log"),
    seed = 123
  )

```

## Data Trend

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: fig-result
#| fig-cap: Trend for Top 5 Causes

filtered_data |>
  ggplot(aes(x = calendar_year, y = total_deaths, color = cause)) +
  geom_line() +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  labs(x = "Year", y = "Annual number of deaths in Alberta") +
  facet_wrap(vars(cause), dir = "v", ncol = 1) +
  theme(legend.position = "none",
        axis.text.y = element_text(size = rel(0.7)))

```

Results in the @fig-result displays the annual number of deaths in Alberta for the top five causes in 2019 unveils distinct trends for each cause over approximately two decades. The data suggest a relatively stable trend in deaths from acute myocardial infarction, with a small rise that may indicate a steady prevalence of risk factors or an equilibrium between advancing medical interventions and demographic shifts. Conversely, the increasing trajectory seen in deaths due to chronic diseases points to a potential escalation in lifestyle-related health issues or could reflect the demographic realities of an aging population.

Particularly notable is the sharp increase in deaths attributed to organic dementia, surging upwards more markedly in the latter half of the time span. This trend could signify heightened awareness and improved diagnostic capabilities, alongside the impact of an aging society. Meanwhile, deaths from malignant neoplasms related to the respiratory system display minor fluctuations, hinting at persistent challenges in cancer prevention, detection, and treatment. The upward trend in chronic obstructive pulmonary disease-related mortality could be linked to environmental factors or historic smoking patterns, underscoring the pressing need for robust public health policies and effective healthcare strategies.

## Modeling

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: tbl-summary
#| tbl-cap: summary of modeling

name_mapping <- 
  c("causeAll other forms of chronic ..."
    = "other chronic",
    "causeMalignant neoplasms of trac..."
    = "neoplasms",
    "causeOrganic dementia"
    = "dementia",
    "causeOther chronic obstructive p..."
    = "obstructive pulmonary"
  )

modelsummary(
  list(
    "Poisson" = cause_of_death_alberta_poisson,
    "Negative binomial" = cause_of_death_alberta_neg_binomial
  ),
  coef_map = name_mapping
)
```

Then the @tbl-summary summarizes the coefficients of both models built to fit the mortality trend in Alberta, offering a comparison of their estimations for the top causes of mortality. In both models, "other chronic" conditions and "neoplasms" exhibit positive coefficients, suggesting these causes of death have an increasing trend over time. Meanwhile, "obstructive pulmonary" diseases show a negative relationship in both models, indicating a decreasing trend in mortality rates. The consistency across both models reinforces the reliability of our findings.

As depicted by the graphs for the Poisson (@fig-poisson_model) and negative binomial models (@fig-negative_binomial_model), the diagnostic plots further elucidate the model fits. The negative binomial model, appears to capture the dispersion in the data more effectively than the Poisson model, which is evident in two plots. The spread of the simulated lines (y_rep) around the observed data (y) suggests that the negative binomial model may accommodate the overdispersion present in the data, which is a common characteristic in count data such as mortality rates.

The presence of multiple peaks in the second plot's simulated data distributions indicates potential subgroups within the data or non-linearity in the mortality trends that the Poisson model may not be accounting for. Such patterns underscore the importance of considering different model structures when dealing with complex datasets. These graphical diagnostics not only affirm the adequacy of the negative binomial model over the Poisson model for this particular dataset but also highlight the necessity of thorough model checking in the process of statistical analysis.

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: fig-poisson_model
#| fig-cap: Poisson Model

pp_check(cause_of_death_alberta_poisson) +
  theme(legend.position = "bottom")

```

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-pos: 'h'
#| label: fig-negative_binomial_model
#| fig-cap: Negative Binomial Model

pp_check(cause_of_death_alberta_neg_binomial) +
  theme(legend.position = "bottom")

```

# Discussion



# Conclusion






\newpage




\newpage


# References


